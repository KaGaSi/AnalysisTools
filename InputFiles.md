Format of input files for all utilities {#InputFiles}
=====

All the utilities read information about studied system from [vsf/vcf
files](https://github.com/olenz/vtfplugin/wiki/VTF-format) (formatted as
described below) and `FIELD` file (input file for [DL_MESO simulation
package](http://www.scd.stfc.ac.uk//research/app/ccg/software/DL_MESO/40694.aspx)).
Coordinates are read from a `.vcf` file (with either
[ordered timesteps](\ref OrderedCoorFile) or
[indexed timesteps](\ref IndexedCoorFile)). Structure of the system (names
and numbers of beads and molecules, etc.) is read from `FIELD` file and
`.vsf` files, but only bead types that are in the above mentioned `.vcf`
file are considered.

Structure file {#StructureFile}
=====

The software package is designed with file `dl_meso.vsf` in mind, which is
generated by the `traject` utility provided in DL_MESO software (and
modified by me). Generally, the utilities are tested only against files
generated by `traject`, but other `.vsf` files (such as the one generated
by `TransformVsf` utility) should work fine, if
formatted according to the following guidelines.

The first mandatory line specifies default bead type which means all atom
lines for beads of this type are unnecessary (provided those beads are not
in a molecule). All atom lines in `dl_meso.vsf` specify VDW radius and atom
name. If an atom is in a molecule, its molecule number is appended to the
atom line as `resid <id>`:
> `atom default radius 1.000000 name <name>`
>
> `...`
>
> `atom <id> radius 1.000000 name <name> resid <id>`
>
> `...`

Only the bead number and name are read, so both VDW radius and molecule
number are not strictly necessary.  Short version of `atom` and `name`
keywords (`a` and `n` respectively) can be used.  Other keywords can be
included, because they will be ignored. No comments are allowed in `.vsf`
file.

Bond lines of `.vsf` files are not read and are therefore irrelevant to
all the utilities.

Optional bond file {#BondFile}
=====

Bonds for each molecule type are specified in `FIELD`, but they can be read
from a different file if required.

The file with molecule bonds must contain name of the molecule type (same
as in `FIELD`) followed by number of bonds on the next line and on every
subsequent line two index numbers corresponding to the two connected beads
(bead numbers start from one and are ordered according to beads in `FIELD`
section for the given molecule). The bead numbers do not have to be sorted
in any way and no blank lines should be present.

Example of bond file:

> `triangle`
>
> `3`
>
> `1 2 possible`
>
> `3 1`
>
> `2 3 comment`

This file must be used for molecule types that have only some of its beads
in `.vcf` file with indexed timesteps. In such a case, the bead indices
correspond to `FIELD` as if the bead types not present in `.vcf` are not
present `FIELD`. Example `FIELD`:

> `...`
>
> `beads 3`
>
> `A <float> <float> <float>`
>
> `B <float> <float> <float>`
>
> `A <float> <float> <float>`
>
> `bonds 3`
>
> `harm 1 2 <float> <float>`
>
> `harm 1 3 <float> <float>`
>
> `harm 2 3 <float> <float>`
>
> `finish`

Assuming only bead types `A` are present in `.vcf` file, the now necessary
bond file would like like this:

> `name`
>
> `1`
>
> `1 2 possible comment`

Bond information about molecule types not present in the bond file will be read
from `FIELD`.

Ordered coordinate file {#OrderedCoorFile}
=====

First line of `.vcf` file with ordered timestep(s) contains box size. Each
timestep starts with a comment line (i.e. line starting with `#` sign), the
second line contains `timestep` (or the short version, `t`) and each
following line contains the coordinates of a single bead. Every bead from
`.vsf` structure file must be present in each timestep.

Exactly one blank line must be between every two timesteps and no blank
lines are allowed at the end of the file.

Example of ordered coordinate file:

> `pbc <float> <float> <float>`
>
> `<blank line>`
>
> `# 1`
>
> `timestep`
>
> `<float> <float> <float>`
>
> `...`

Indexed coordinate file {#IndexedCoorFile}
=====

Unlike the `.vcf` file with ordered timesteps, the `.vcf` file with indexed
timestep does not contain coordinates for every bead. Only beads of
selected bead types are present and their names are written as comments at
the beginning of the file (and followed by a blank line). Every bead is
prepended by its index number according to the `.vsf` structure file.
Keyword `timestep` (or `t`) at the beginning of every timestep is replaced
by `indexed` (or its short version, `i`). Otherwise the file has the same
format as the `.vcf` file with ordered timesteps.

Example of indexed coordinate file:

> `# name`
>
> `...`
>
> `<blank line>`
>
> `pbc <float> <float> <float>`
>
> `<blank line>`
>
> `# 1`
>
> `indexed`
>
> `<id> <float> <float> <float>`
>
> `...`
