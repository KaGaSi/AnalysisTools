\section{Aggregates and Aggregates-NotSameBeads} \label{sec:Aggregates}

These utilities determine which molecules belong to which aggregates
according to a simple criterion: two molecules belong to the same aggregate
if they share at least a specified number of contact pairs. A contact pair
is a pair of two beads belonging to different molecules which are closer
than a specified distance.

The number of contact pairs, the distance, and bead type(s) to use for
aggregate determination are all arguments of the utilities.  Any molecule
type(s) can be excluded from aggregate determination (and therefore from
the output \texttt{agg} file).

While the \texttt{Aggregates} utility uses all possible pairs of given bead
types, \texttt{Aggrega}-\texttt{tes-NotSameBeads} does not use same-type pairs. For
example, if bead types \texttt{A} and \texttt{B} are given,
\texttt{Aggregates} will use all three possible bead type pairs (i.e.,
\texttt{A-A}, \texttt{A-B}, and \texttt{B-B}), but
\texttt{Aggregates-NotSameBeads} will use only \texttt{A-B} bead type
pairs.

Also, periodic boundary conditions can be removed from whole aggregates and
the new coordinates saved to an indexed \texttt{vcf} file (\texttt{-j}
option). Therefore aggregates will not be split by simulation box
boundaries when, for example, visualizing the molecules with vmd.

The information is written in \texttt{agg} format which is described in
Section~\ref{sec:AggFile}.

Usage:

\noindent
\vspace{1em}
\texttt{Aggregates} (or \texttt{Aggregates-NotSameBeads}) \texttt{<input>
<distance> <contacts> <output.agg> <bead type name(s)> <options>}

\vspace{1em}
\noindent
\begin{longtable}{p{0.24\textwidth}p{0.704\textwidth}}
  \toprule
  \multicolumn{2}{l}{Mandatory arguments} \\
  \midrule
  \texttt{<input>} & input coordinate file (either \texttt{vcf} or
    \texttt{vtf} format) \\
  \texttt{<distance>} & minimum distance for two beads to be in contact
    (thus constituting a contact pair) \\
  \texttt{<contacts>} & minimum number of contact pairs between two
    molecules to be in one aggregate \\
  \texttt{<output.agg>} & output \texttt{agg} file (must end in
    \texttt{.agg}) with aggregate information \\
  \texttt{<bead type(s)>} & bead type name(s) to use for determining
    contact pairs (at least two for \texttt{Aggregates-NotSameBeads}) \\
  \texttt{<options>} & \\
  \toprule
  \multicolumn{2}{l}{Non-standard options} \\
  \midrule
  \texttt{-x <mol name(s)>} & exclude specified molecule type(s) from
    aggregate determination (and from the output \texttt{agg} file) \\
  \texttt{-j <output.vcf>} & output \texttt{vcf} file with coordinates of
    joined aggregates (i.e., without periodic boundary conditions) \\
  \bottomrule
\end{longtable}
