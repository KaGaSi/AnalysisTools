\subsection[VtfReadPBC]{Get simulation box dimensions from \vtf
  file}\label{ssec:VtfReadPBC}

This function reads an input \vcf file line by line, searching for a \tt{pbc}
line containing box dimensions and, optionally, angles (for triclinic cells).
The function takes only the first valid \tt{pbc} line.

Valid line: \tt{pbc <x> <y> <x> [<alpha> <beta> <gamme>] ... anything else}.

\CallInit{void VtfReadPBC}
\begin{longtable}{L{0.23\textwidth}Mp{0.64\textwidth}}
  \toprule
  parameter          & in/out & explanation \\
  \midrule
  \ttb{(char) input_vcf[]} & in  & name of the input \vcf file \\
  \ttb{(BOX) Box}          & out & information about simulation box dimensions
    (section \ref{ssec:Box})\\
  \bottomrule
\end{longtable}
\begin{itemize}
  \item the \ttb{input_vcf} is read line by line until one of the following
    happens:
    \begin{itemize}
      \item valid \tt{pbc} line is encountered
      \item coordinate line is encountered; exit program with error
      \item invalid line is encountered, i.e., anything beside \tt{atom},
        \tt{bond}, comment (\tt{\#}-initiated line), or \tt{timestep} line; exit
        program with error
    \end{itemize}
\end{itemize}

% old stuff with full pseudocode %{{{
\begin{comment}
\CallInit{void}{VtfReadPBC}
\begin{longtable}{p{0.23\textwidth}@{\hspace{-20pt}}
                  >{\centering}m{0.2\textwidth}@{\hspace{-10pt}}
                  p{0.64\textwidth}}
  \toprule
  variable           & in/out & explanation \\
  \midrule
  \ttb{(char) input_vcf[]} & in  & name of the input \vcf file \\
  \ttb{(BOX) Box}          & out & information about simulation box dimensions
    \TODO add ref\\
  \bottomrule
\end{longtable}
\vspace{-1em}
\begin{algorithmic}[1]
  \St open \ttb{input_vcf}
  \St $file\_line\_count \gets 0$\Comment{count lines; line number printed in
    case of an error}
  \While{$line\gets$ get a line from \ttb{input_vcf}}
    \St $file\_line\_count\gets file\_line\_count+1$
    \If{$line$ is \hltt{pbc} line}
      \St \ttb{Box.Length}$\gets$ 1st to 3rd string from $line$ as box
        dimensions
      \St \ttb{Box}$\gets 90^\circ$ as all three angles\Comment{assume
        orthogonal box}
      \If{\hltt{pbc} line contains angles}
        \St \ttb{Box} $\gets$ 4th to 6th string from $line$ as
          angles\Comment{possibly triclinic box}
      \EndIf
      \Break\Comment{box dimensions found, so there's nothing more to do}
    \ElsIf{$line$ is a coordinate line}
      \Error missing box dimensions in \ttb{input_vcf}
    \ElsIf{$line$ is unrecognised}
      \Error invalid line in \ttb{input_vcf}
    \EndIf
  \EndWhile
  \St close \ttb{input_vcf}
\end{algorithmic}
\algbottomrule
\end{comment}
 %}}}
