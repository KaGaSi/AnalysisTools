\subsection[VtfReadPBC]{Get simulation box dimensions}\label{ssec:VtfReadPBC}

This function reads an input \vcf file line by line, searching for a valid
\tt{pbc} line that contains box dimensions and, optionally, angles (for
triclinic cells). The function takes only the first valit \tt{pbc} line.

Valid line: \tt{pbc <x> <y> <x> [<alpha> <beta> <gamme>]}.

\CallInit{void}{VtfReadPBC}
\begin{longtable}{m{0.23\textwidth}
                  >{\centering}m{0.2\textwidth}
                  m{0.57\textwidth}}
  \toprule
  variable           & in/out & explanation \\
  \midrule
  \ttb{(char) input_vcf[]} & in  & name of the input \vcf file \\
  \ttb{(BOX) Box}          & out & information about simulation box dimensions
    \TODO add ref\\
  \bottomrule
\end{longtable}
\vspace{-1em}
\begin{algorithmic}[1]
  \St open \ttb{input_vcf}
  \St $file\_line\_count \gets 0$\Comment{count lines; line number printed in
    case of an error}
  \While{$line\gets$ get a line from \ttb{input_vcf}}
    \St $file\_line\_count\gets file\_line\_count+1$
    \If{$line$ is \hltt{pbc} line}
      \St \ttb{Box.Length}$\gets$ 1st to 3rd string from $line$ as box
        dimensions
      \St \ttb{Box}$\gets 90^\circ$ as all three angles\Comment{assume
        orthogonal box}
      \If{\hltt{pbc} line contains angles}
        \St \ttb{Box} $\gets$ 4th to 6th string from $line$ as
          angles\Comment{possibly triclinic box}
      \EndIf
      \Break\Comment{box dimensions found, so there's nothing more to do}
    \ElsIf{$line$ is a coordinate line}
      \Error missing box dimensions in \ttb{input_vcf}
    \ElsIf{$line$ is unrecognised}
      \Error invalid line in \ttb{input_vcf}
    \EndIf
  \EndWhile
  \St close \ttb{input_vcf}
\end{algorithmic}
\algbottomrule
